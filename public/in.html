<!DOCTYPE html>
<html>
	<head>
		<title>Training input</title>
		<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/styles/github.min.css">
		<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script>
		<script>
			hljs.configure({
				tabReplace: '    ',
				languages: ['javascript']
			});
			hljs.initHighlightingOnLoad();
		</script>
	</head>

	<body>
		<div>
			<textarea rows="20" cols="100" id="in" onkeyup="push()">
				function bootstrap () {
					var a := 1;
				}
			</textarea>
		</div>
		<pre>
			<code class="javascript" id="code"></code>
		</pre>

		<script type="text/javascript">
			var connection = new WebSocket('ws://'+document.location.host+'/', 'echo-protocol');

			connection.onerror = function (error) {
				console.log('WebSocket Error ' + error);
			};

			connection.onopen = function () {
				connection.send(document.getElementById("in").innerHTML);
			};

			connection.onmessage = function (message) {
				document.getElementById("code").innerHTML = message.data;
			};

			function push() {
				var x = document.getElementById("in");

    			connection.send(x.value);
			}
		</script>
	</body>
</html>